<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd">
    <changeSet author="boy@ibuildings.nl" id="1288716266181-1">
        <createTable tableName="consent">
            <column name="consent_date" type="TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column defaultValue="0000-00-00 00:00:00" name="usage_date" type="TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="hashed_user_id" type="VARCHAR(80)">
                <constraints nullable="false"/>
            </column>
            <column name="service_id" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="attribute" type="VARCHAR(80)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="boy@ibuildings.nl" id="1288716266181-2">
        <createTable tableName="user_attributes">
            <column name="user_uid" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="value" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="boy@ibuildings.nl" id="1288716266181-3">
        <createTable tableName="users">
            <column name="uid" type="VARCHAR(255)">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="created" type="TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="last_seen" type="DATETIME">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="boy@ibuildings.nl" id="1288716266181-4">
        <addPrimaryKey columnNames="hashed_user_id, service_id" tableName="consent"/>
    </changeSet>
    <changeSet author="boy@ibuildings.nl" id="1288716266181-5">
        <addPrimaryKey columnNames="user_uid, name, value" tableName="user_attributes"/>
    </changeSet>
    <changeSet author="boy@ibuildings.nl" id="1288716266181-7">
        <createIndex indexName="hashed_user_id" tableName="consent" unique="false">
            <column name="hashed_user_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="boy@ibuildings.nl" id="1288716266181-8">
        <createIndex indexName="service_id" tableName="consent" unique="false">
            <column name="service_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="boy@ibuildings.nl" id="1288716266181-10">
        <createIndex indexName="name" tableName="user_attributes" unique="false">
            <column name="name"/>
        </createIndex>
    </changeSet>
    <changeSet author="boy@ibuildings.nl" id="1288716266181-11">
        <createIndex indexName="user_uid" tableName="user_attributes" unique="false">
            <column name="user_uid"/>
        </createIndex>
    </changeSet>
</databaseChangeLog>
